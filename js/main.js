function heartBeat(){document.getElementById("heart").classList.add("activated");var e=new Audio("musics/heartbeat.mp3");e.play()}function createAudioMeter(e,t,n,i){var o=e.createScriptProcessor(512);return o.onaudioprocess=volumeAudioProcess,o.clipping=!1,o.lastClip=0,o.volume=0,o.clipLevel=t||.58,o.averaging=n||.95,o.clipLag=i||750,o.connect(e.destination),o.checkClipping=function(){return this.clipping?(this.lastClip+this.clipLag<window.performance.now()&&(this.clipping=!1),this.clipping):!1},o.shutdown=function(){this.disconnect(),this.onaudioprocess=null},o}function volumeAudioProcess(e){for(var t,n=e.inputBuffer.getChannelData(0),i=n.length,o=0,a=0;i>a;a++)t=n[a],Math.abs(t)>=this.clipLevel&&(this.clipping=!0,this.lastClip=window.performance.now()),o+=t*t;var r=Math.sqrt(o/i);this.volume=Math.max(r,this.volume*this.averaging)}function startCapture(){canvasContext=document.getElementById("meter").getContext("2d"),window.AudioContext=window.AudioContext||window.webkitAudioContext,audioContext=new AudioContext;try{navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia({audio:{mandatory:{googEchoCancellation:"false",googAutoGainControl:"false",googNoiseSuppression:"false",googHighpassFilter:"false"},optional:[]}},gotStream,didntGetStream)}catch(e){alert("getUserMedia threw exception :"+e)}}function didntGetStream(){alert("Stream generation failed.")}function gotStream(e){mediaStreamSource=audioContext.createMediaStreamSource(e),meter=createAudioMeter(audioContext),mediaStreamSource.connect(meter),drawLoop()}function drawLoop(e){canvasContext.clearRect(0,0,WIDTH,HEIGHT),meter.checkClipping()?Reveal.next():canvasContext.fillStyle="green",canvasContext.fillRect(0,0,meter.volume*WIDTH*1.4,HEIGHT),rafID=window.requestAnimationFrame(drawLoop)}Reveal.initialize({controls:!1,progress:!1,history:!0,center:!0,transition:"fade",dependencies:[{src:"/js/vendor/classList.js",condition:function(){return!document.body.classList}},{src:"js/vendor/highlight/highlight.js",async:!0,condition:function(){return!!document.querySelector("pre code")},callback:function(){hljs.initHighlightingOnLoad()}},{src:"js/vendor/notes/notes.js",async:!0}]});var audioContext=null,meter=null,canvasContext=null,WIDTH=500,HEIGHT=50,rafID=null,btnStart=document.getElementById("btnStart");btnStart.addEventListener("click",startCapture);var mediaStreamSource=null;